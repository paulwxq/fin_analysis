一、项目背景：
本文档设计了一个**混合型**量化选股工具，结合传统数学规则与 AI 视觉识别能力，精准挖掘“长期超跌、底部横盘”的潜力标的。
当前模块refinement_llm基于已经通过初筛的股票的月K线，通过多模态LLM找到“曾经大涨 → 大幅回撤 → 近 2~3 年横盘起伏不大”的股票形态。

二、refinement_llm模块的业务需求：
1.从指定目录中读取 *.png 图形(股票的月K线图)，访问所有的文件提交给LLM评估。
2.模块脚本在执行的时候，可以添加参数指定月K线的图文件所在的目录，如果不指定就是读取.output/*.png.
3.月K线图的文件命名方式“股票编码”_kine.png，例如：000876.SZ_kline.png，下划线前面的内容就是股票的编码。
4.重要：请将股票的月K线图提交给LLM进行评分，提示词和评分规则可以参考同目录在的“参考设计1.md”和"参考设计2.md"、""三份文档。你可以参考这两份文档，设计评分规则。
5.LLM对股票的月K线图进行评分，按照json返回，至少包含股票编码、评分分数、评分原因等信息。
6.将评分返回的结果写入到数据库表中，表名为：public.stock_flatbottom_refinement，你可以根据上面json返回的结果设计表的结构，这个表的主键就是股票编码。每次写入表之前，都要自动清空这个表。
7.评分返回的结果还要写入到日志文件中，使用logger作为模块的日志，可以为控制台和日志文件配置不同的日志级别，日志默认写在项目根目录下的./logs，日志名为 refinement_llm.log

三、技术栈：
1.沿用当前项目的技术栈，python3.12.x，使用uv管理项目的虚拟环境，项目根目录下的.venv是整个项目的虚拟环境。
2.当前模块使用的LLM，采用 MS Agent-Framework 的最新的版本python-1.0.0b260127，需要使用uv安装。
https://github.com/microsoft/agent-framework/releases/tag/python-1.0.0b260127
3.需要支持多种LLM，当前模块默认使用qwen-plus，以Openai兼容模式运行，后续也会添加OpenAI的模型，或者deepseek的模型等等。
4.LLM的配置信息保持在项目根目录下的 .env文件中，它包括：
DASHSCOPE_API_KEY
DASHSCOPE_BASE_URL
5.当前模块开发阶段使用的是qwen-plus模型，具体使用的模型名称在模块的 config.py 中定义。
6.当前模块所有的代码都放在子目录 refinement_llm 下。